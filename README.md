# Project 7 - WordPress Pentesting

Time spent: **10** hours spent in total

> Objective: Find, analyze, recreate, and document **five vulnerabilities** affecting an old version of WordPress

## Pentesting Report

### 1. (Required) Title: WordPress <= 4.2 - Unauthenticated Stored Cross-Site Scripting (XSS)
  - [ ] Summary: Current versions of WordPress (Version's up to 4.2) are vulnerable to a stored XSS. An unauthenticated attacker can inject JavaScript in WordPress comments and in turn the script is triggered when the comment is viewed.
   
    - Vulnerability types: XSS
    - Tested in version: 4.2
    - Fixed in version: 4.2.1
    
  - [ ] GIF Walkthrough: <img src="cross_site_scripting.gif" alt="Cross-Site Scripting (XSS)">
  - [ ] Steps to recreate: You need an admin to approve a comment containing the embedded harmful html tag which I included below. If the comment text is long enough, it will be truncated when inserted in the database. The truncation results in malformed HTML generated on the page.

    `<a title='x onmouseover=alert(unescape(/hello%20world/.source)) style=position:absolute;left:0;top:0;width:5000px;height:5000px AAAAAAAAAAAA     [64 kb] ...'></a>`

  - [ ] Affected source code: 
    - [Link 1](https://core.trac.wordpress.org/browser/tags/4.2.2/src/wp-admin/post.php)
    - [Link 2](http://klikki.fi/adv/wordpress2.html)
    - [Link 3](https://www.exploit-db.com/exploits/36844/)
    
### 2. (Required) Title: 2.5-4.6 - Authenticated Stored Cross-Site Scripting via Image Filename
  - [ ] Summary: Cross-site scripting (XSS) vulnerability in the media_handle_upload function in wp-admin/includes/media.php in WordPress before 4.6.1 can allow remote attackers to inject arbitrary web script or HTML by tricking an administrator into uploading an image file that has a crafted filename.
    - Vulnerability types: XSS
    - Tested in version: 4.2
    - Fixed in version: 4.6.1
    
  - [ ] GIF Walkthrough: <img src="cross_site_scripting_image.gif" alt="Authenticated Stored Cross-Site Scripting via Image Filename">
  - [ ] Steps to recreate: A admin must approve of an image with a crafted filename as the following code snippit below. The XSS will be triggered whenever a user loads a page that contains the image.
  
    `a<img src=a ONERROR=alert('XSS')>`
  
  - [ ] Affected source code:
    - [Link 1](https://core.trac.wordpress.org/browser/tags/4.2.2/src/wp-admin/includes/media.php)
    - [Link 2](https://sumofpwn.nl/advisory/2016/persistent_cross_site_scripting_vulnerability_in_wordpress_due_to_unsafe_processing_of_file_names.html)
    - [Link 3](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-7168)
    
### 3. (Required) Title: WordPress  4.0-4.7.2 - Authenticated Stored Cross-Site Scripting (XSS) in YouTube URL Embeds
  - [ ] Summary: A cross-site scripting (XSS) vulnerability which allows authenticated users to insert malicious JavaScript code in YouTube URL Embeds.
    - Vulnerability types: XSS
    - Tested in version: 4.2
    - Fixed in version: 4.7.3
    
  - [ ] GIF Walkthrough:<img src="cross_site_scripting_youtube.gif" alt="Authenticated Stored Cross-Site Scripting via Youtube URL Embeds"> 
  - [ ] Steps to recreate: An admin must approve of a post with an embbed youtube URL link, which I included down below. Everytime a user refreshes the page, they will be alerted with a popup.
  
    `[embed src='https://youtube.com/embed/12345\x3csvg onload=alert(1)\x3e'][/embed]`

- [ ] Affected source code:
    - [Link 1](https://core.trac.wordpress.org/browser/tags/4.2/src/wp-includes/class-wp-embed.php)
    - [Link 2](https://github.com/WordPress/WordPress/commit/419c8d97ce8df7d5004ee0b566bc5e095f0a6ca8)
    - [Link 3](https://blog.sucuri.net/2017/03/stored-xss-in-wordpress-core.html)
    

## Assets

List any additional assets, such as scripts or files

## Resources

- [WordPress Source Browser](https://core.trac.wordpress.org/browser/)
- [WordPress Developer Reference](https://developer.wordpress.org/reference/)

GIFs created with [Kap](https://getkap.co/).

## Notes

One challenge I encountered when I was completing the project, was getting WordPress 4.1-4.2.1 - Unauthenticated Genericons Cross-Site Scripting (XSS) to run. In this particular vulnerability, it seemed as simple as manipulating the URL link, but I could not change the URL link to alert the user of a breach of the website. I spent nearly 3 hours trying to use URL manipulation as well as changing my theme to the 2015 theme, yet received no response from the website. 

## License

    Copyright [2020] [Hope Dunner]

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
